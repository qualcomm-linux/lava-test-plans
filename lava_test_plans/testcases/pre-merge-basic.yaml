{% extends "testcases/templates/master.jinja2" %}

{% set test_name = test_name | default("pre-merge-basic") %}
{% set test_timeout = 240 %}

{# Get excluded tests list from device file #}
{% set EXCLUDED_TESTS = EXCLUDED_TESTS|default([]) %}

{# Define all tests with their details and pre-evaluate conditions #}
{% set all_tests = [
    {"name": "hotplug", "path": "Runner/suites/Kernel/Baseport/hotplug/hotplug.yaml"},
    {"name": "CPUFreq_Validation", "path": "Runner/suites/Kernel/Baseport/CPUFreq_Validation/CPUFreq_Validation.yaml"},
    {"name": "Interrupts", "path": "Runner/suites/Kernel/Baseport/Interrupts/Interrupts.yaml"},
    {"name": "cdsp_remoteproc", "path": "Runner/suites/Kernel/Baseport/cdsp_remoteproc/cdsp_remoteproc.yaml"},
    {"name": "adsp_remoteproc", "path": "Runner/suites/Kernel/Baseport/adsp_remoteproc/adsp_remoteproc.yaml"},
    {"name": "WiFi_Firmware_Driver", "path": "Runner/suites/Connectivity/WiFi/WiFi_Firmware_Driver/WiFi_Firmware_Driver.yaml"},
    {"name": "WiFi_OnOff", "path": "Runner/suites/Connectivity/WiFi/WiFi_OnOff/WiFi_OnOff.yaml"},
    {"name": "OpenCV", "path": "Runner/suites/Multimedia/OpenCV/OpenCV.yaml"},
    {"name": "irq", "path": "Runner/suites/Kernel/Baseport/irq/irq.yaml"},
    {"name": "BT_ON_OFF", "path": "Runner/suites/Connectivity/Bluetooth/BT_ON_OFF/BT_ON_OFF.yaml"},
    {"name": "AudioRecord", "path": "Runner/suites/Multimedia/Audio/AudioRecord/AudioRecord.yaml"},
    {"name": "AudioPlayback", "path": "Runner/suites/Multimedia/Audio/AudioPlayback/AudioPlayback.yaml", "include": (AUDIO_CLIPS_URL is defined and AUDIO_CLIPS_URL), "params": {"AUDIO_CLIPS_BASE_DIR": "/home/AudioClips/"}},
    {"name": "Ethernet", "path": "Runner/suites/Connectivity/Ethernet/Ethernet.yaml"},
    {"name": "DSP_AudioPD", "path": "Runner/suites/Multimedia/DSP_AudioPD/DSP_AudioPD.yaml"},
    {"name": "fastrpc_test", "path": "Runner/suites/Multimedia/CDSP/fastrpc_test/fastrpc_test.yaml"}
] %}

{% block test_target %}
  {{ super() }}
    {% for test in all_tests %}
    {# Check if test should be included (not excluded AND condition met if specified) #}
    {% if (test.name not in EXCLUDED_TESTS) and (test.include|default(true)) %}
    - from: git
      name: "{{ test.name }}"
      path: {{ test.path }}
      repository: {{ TEST_DEFINITIONS_REPOSITORY }}
      {% if test.params is defined %}
      params:
        {% for param_key, param_value in test.params.items() %}
        {{ param_key }}: "{{ param_value }}"
        {% endfor %}
      {% endif %}
    {% endif %}
    {% endfor %}
{% endblock test_target %}
